#!/bin/sh

echo "🔍 [1] 스테이징된 TypeScript 파일 타입 검사 시작"

# 1. 스테이징된 파일 목록에서 .ts/.tsx만 필터링
FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$' || true)


echo "🔍 [2] 필터링된 파일 목록:"
echo "$FILES"

# 2. 검사 대상이 없으면 커밋 진행
if [ -z "$FILES" ]; then
  echo "✅ [3] 검사할 TypeScript 파일 없음. 커밋 계속 진행"
  exit 0
fi

echo "🧪 [4] 검사 대상 존재: $FILES"


STATUS=$?
if [ $STATUS -ne 0 ]; then
  echo "❌ 타입 오류가 발생했습니다. 커밋이 중단됩니다."
  exit 1
fi

echo "✅ [5] 모든 파일 타입 검사 통과. 커밋 진행"
exit 0
